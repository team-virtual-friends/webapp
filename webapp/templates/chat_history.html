<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-GT5XWFJV12"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());
        gtag('config', 'G-GT5XWFJV12');
    </script>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />

    <!-- Core theme CSS (includes Bootstrap)-->
    <link href="{{ url_for('static', filename='css/styles.css') }}" rel="stylesheet" />

    <title>Chat History - Virtual Friends</title>
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}" />

    <style>
        /* Additional styles for chat history */
        .chat-card {
            margin: 20px 0;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 8px;
        }

        .chat-message {
            margin-bottom: 10px;
        }
    </style>
</head>

<body>

<section id="page-top">
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark navbar-custom fixed-top">
        <div class="container px-5">
            <a class="navbar-brand" href="{{ url_for('home') }}">
                <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Virtual Friends Logo" height="40" style="margin-right: 10px;">Virtual Friends
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarResponsive">
                <ul class="navbar-nav ms-auto"></ul>
            </div>
        </div>
    </nav>
</section>

<header class="masthead text-center text-white">
    <div class="masthead-content">
        <div class="container px-5">
            <h2 class="masthead-subheading mb-0">Chat History</h2>
        </div>
    </div>
    <!-- Background circles -->
    <div class="bg-circle-1 bg-circle"></div>
    <div class="bg-circle-2 bg-circle"></div>
    <div class="bg-circle-3 bg-circle"></div>
    <div class="bg-circle-4 bg-circle"></div>
</header>

<div class="container mt-5 mb-5">
    {% for row in chat_history %}
        <div class="chat-card">
            <strong>Chat Session ID:</strong> {{ row['chat_session_id'] }}<br>
            <strong>Timestamp:</strong> {{ row['timestamp'] }}<br>
            <div>
                {% set chats = row['chat_history'].split('\n') %}
                {% for chat in chats %}
                    {% if chat %}
                        <div class="chat-message">{{ chat|replace('\n', '<br>')|safe }}</div>
                    {% endif %}
                {% endfor %}
            </div>
        </div>
    {% endfor %}
</div>

</body>
</html>
